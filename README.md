
## 主要技术：gulp 、jQuery、 H5、 css3、 cookie等。

[线上地址](http://47.107.117.248/music/dist/html/index.html)
音乐加载没有做优化，所以尽管没加载过来也会播放
虽然项目不算大，但维护起来是真的难，以后或许会优化，但不会加新功能了..........

## **实现的功能有：**
-  播放和暂停音频：播放状态下，碟盘旋转且唱臂搭在碟盘上，暂停状态下，碟盘停止旋转且唱臂弹回，当再次播放时，碟盘从刚才停止的位置进行旋转
- 滑屏切歌：碟盘可跟随鼠标进行滑动，且切入的碟盘刚一出现就渲染好切入盘要展现的歌曲图片，当碟盘滑动到一定位置进行有过渡动画的切歌；当没有滑到位时松开鼠标，碟盘自动弹回播放位置。
-  左右切歌：具有切歌过渡动画。
-  播放列表切歌：当前播放的歌曲，在列表中被选中为播放状态，列表每次被点击出来都会重新获取一遍，达到更新效果，点击列表中的歌曲后，该歌曲被播放且被选中为播放状态，碟盘无过渡动画，但碟盘重新从零开始旋转。
-  进度条：动态渲染当前歌曲已播放的时间，可进行拖动播放音乐且拖动时，已播放的时间随着拖动进行变化。
-  红心：可点击的收藏和取消收藏。
-  cookie保存当前正在播放歌曲的索引，以便下次打开直接播放当前音频播放完自动切歌且有切歌动画
-  背景为当前歌曲图片的高斯模糊。
- 其他：一些细节问题，具体可以参照移动端的网易云音乐。

## **因为是模块化开发，所以要介绍起来一两句话说不清楚，所以就简要说明几个难点，而且里面有大量注释。**

*一些难点：*

 1. 碟盘旋转问题，暂停保留当前需旋转角度，切歌也会进行保留，不能达到理想效果。
 2. 滑屏切歌和左右切歌的过渡动画不能连贯，滑屏切就不能左右切歌。
 3. 进度条问题。

 *解答*：
1. 首先明确一点，需要保留旋转角度的只有歌曲暂停时需要，其余情况都要置零，即不但要从零开始旋转，而且还要将切入和切出的碟盘的样式也要清零。
2. 首先两种切歌的方式有很大的不同，滑屏的是切入盘跟随切出盘进行移动，切出盘又跟随鼠标移动，所以用拖拽；而左右歌只是一个位置切到另一个位置，中间再加上了过渡动画而已，所以可以用关键帧，而造成这个问题主要原因是运动的属性不同，要么都用left,或者都用transform,这里我用的是3个盘进行切换，然后将这3个盘的初始位置用transform进行固定，用left进行移动，当各盘过渡动画运动完成后更改class类名。
3. 进度条可以用已播放时间占歌曲总时间的百分比来做，当开始播放音频时用getDate()来获取当前这一时刻，然后设置一个定时器requestAnimationFrame，运用递归来动态获取渲染这一帧动画所用时间占总时间的百分比，然后让小圆点按进度条宽的百分比进行移动；同样的拖拽小圆点后松开鼠标后，计算出当前位置到初始位置长度与进度条的宽度的百分比乘以该音频总时间比来求出当前要播放的时间秒数，然后从这个地方开始播放音频，同样暂停需要需要记录下当前播放的时长，其他情况需要把记录已播放时长置零。



数据格式
![image](https://img-blog.csdnimg.cn/20201005224810303.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1poaXFpYW5nX1hpb25n,size_16,color_FFFFFF,t_70#pic_center)
总结：
	
 - 左右大幅滑动切歌会有bug，在网易上有卡顿的问题。
 - 项目中是会有出现一个警告说主动触发了一个可以被动触发的事件，有些搞不明白，但不影响播放，不过如果可以优化可以使页面更具有响应性。
![image](https://img-blog.csdnimg.cn/2020100523562727.PNG#pic_center)

上一个我做的和si一样的动态图，需要展示的东西太多，超过限制，所以删除了动态图的重复帧，大家先凑合着看吧


运行命令：
cnpm run serve

